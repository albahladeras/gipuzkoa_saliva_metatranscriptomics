from snakemake.io import glob_wildcards



lanes = glob_wildcards("~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L00[1-4]_R[12]_001.fastq.gz")
samples = lanes.sample



print("Samples extracted:", samples)

rule all:
    input:
        expand("~/Documentos/SalivaQTL/copenhague_analysis/results/{sample}_R1_concat.fastq.gz", sample=samples),
        expand("~/Documentos/SalivaQTL/copenhague_analysis/results/{sample}_R2_concat.fastq.gz", sample=samples)
       


rule concat_r1:
    input:
        l1_1 ="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L001_R1_001.fastq.gz",
        l2_1="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L002_R1_001.fastq.gz",
        l3_1="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L003_R1_001.fastq.gz",
        l4_1="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L004_R1_001.fastq.gz"
    output:
        "~/Documentos/SalivaQTL/copenhague_analysis/results/{sample}_R1_concat.fastq.gz"
    resources:
        mem_mb=1024, # 1GB 
        runtime=30  # 30m

    shell:
        """
        cat {input.l1_1} {input.l2_1} {input.l3_1} {input.l4_1} > {output}  
        """

rule concat_r2:
    input:
        l1_2="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L001_R2_001.fastq.gz",
        l2_2="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L002_R2_001.fastq.gz",
        l3_2="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L003_R2_001.fastq.gz",
        l4_2="~/Documentos/SalivaQTL/copenhague_analysis/resources/reads/{sample}_L004_R2_001.fastq.gz"
    output:
        "~/Documentos/SalivaQTL/copenhague_analysis/results/{sample}_R2_concat.fastq.gz"
    
    resources:
        mem_mb=1024,  # 1GB 
        runtime=30  # 30m
    shell:
        """
        cat {input.l1_2} {input.l2_2} {input.l3_2} {input.l4_2} > {output}  
        """